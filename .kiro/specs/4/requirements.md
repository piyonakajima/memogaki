# Requirements Document

## Introduction

「瞬発思考」アプリの読み返しモード機能。書き出しモードでタイマー終了後に表示され、ユーザーが書いた内容を振り返り、必要に応じて追記できる。セッション内での現在の進行状況（現在の回数/総回数）を表示し、「次へ」ボタンで次のラウンドへスムーズに遷移させる。書き出しと読み返しのサイクルを繰り返すことで、瞬発的な思考の深掘りを促進する。

## Requirements

### Requirement 1: 書いた内容の表示

**Objective:** ユーザーとして、書き出しモードで入力した内容を読みやすい形式で確認したい。これにより、自分の思考を振り返り、次の書き出しにつなげられる。

#### Acceptance Criteria

1. WHEN 読み返しモードが表示される THEN 読み返しコンポーネント SHALL 書き出しモードで入力されたテキストを表示する
2. WHEN テキストが表示される THEN 読み返しコンポーネント SHALL 読みやすいフォントサイズ（16px以上）で表示する
3. IF 入力されたテキストが空 THEN 読み返しコンポーネント SHALL 「入力がありませんでした」などのプレースホルダーメッセージを表示する
4. WHEN テキストに改行が含まれる THEN 読み返しコンポーネント SHALL 改行を保持して表示する
5. WHILE 読み返しモードがアクティブ THE 読み返しコンポーネント SHALL テキスト表示エリアを画面の主要領域に配置する

### Requirement 2: 追記機能

**Objective:** ユーザーとして、読み返し中に思いついたことを追記したい。これにより、時間制限後も重要な思考を記録できる。

#### Acceptance Criteria

1. WHEN 読み返しモードが表示される THEN 読み返しコンポーネント SHALL 追記用の入力エリアを表示する
2. WHEN ユーザーが追記エリアにテキストを入力する THEN 読み返しコンポーネント SHALL 入力内容をリアルタイムで反映する
3. WHEN 追記エリアが空の状態 THEN 読み返しコンポーネント SHALL プレースホルダーを表示する（例：「追記があればここに...」）
4. IF 追記が入力される THEN 読み返しコンポーネント SHALL 元のテキストと追記を区別可能な形式で保持する
5. WHEN 「次へ」ボタンが押される THEN 読み返しコンポーネント SHALL 元のテキストと追記を統合してセッションに保存する

### Requirement 3: 「次へ」ボタン

**Objective:** ユーザーとして、読み返しを終えて次のラウンドへ進みたい。これにより、セッションをスムーズに継続できる。

#### Acceptance Criteria

1. WHEN 読み返しモードが表示される THEN 読み返しコンポーネント SHALL 「次へ」ボタンを表示する
2. WHEN ユーザーが「次へ」ボタンをクリックする THEN 読み返しコンポーネント SHALL onNext コールバックを呼び出す
3. WHEN 「次へ」ボタンがクリックされる THEN 読み返しコンポーネント SHALL 現在のメモ（元のテキスト＋追記）を確定する
4. WHILE 読み返しモードがアクティブ THE 読み返しコンポーネント SHALL 「次へ」ボタンをタップしやすいサイズ（最小44px）で表示する
5. WHEN 最終ラウンドの読み返しモード THEN 読み返しコンポーネント SHALL 「次へ」ボタンのラベルを「完了」に変更する

### Requirement 4: 現在の回数/総回数の表示

**Objective:** ユーザーとして、セッション内での進行状況を把握したい。これにより、残りのラウンド数を意識しながら取り組める。

#### Acceptance Criteria

1. WHEN 読み返しモードが表示される THEN 読み返しコンポーネント SHALL 現在のラウンド番号と総ラウンド数を表示する（例：「3 / 10」）
2. WHEN 進行状況が表示される THEN 読み返しコンポーネント SHALL 視認しやすい位置（画面上部など）に配置する
3. WHEN 現在のラウンドが進む THEN 読み返しコンポーネント SHALL 表示されるラウンド番号を更新する
4. IF 総ラウンド数が変更される THEN 読み返しコンポーネント SHALL 更新された総ラウンド数を反映する
5. WHILE 読み返しモードがアクティブ THE 読み返しコンポーネント SHALL 進行状況を常に表示し続ける

### Requirement 5: スマホ対応レスポンシブデザイン

**Objective:** ユーザーとして、スマートフォンで快適に読み返しをしたい。これにより、場所を選ばず瞬発思考を実践できる。

#### Acceptance Criteria

1. WHEN 画面幅が768px未満 THEN 読み返しコンポーネント SHALL モバイルレイアウトを適用する
2. WHEN モバイルレイアウトが適用される THEN 読み返しコンポーネント SHALL テキスト表示エリアを画面幅いっぱいに表示する（適切なパディングを除く）
3. WHILE モバイルデバイスで使用中 THE 読み返しコンポーネント SHALL タップ操作に適したUI要素サイズを維持する
4. WHEN デスクトップ画面幅（768px以上） THEN 読み返しコンポーネント SHALL 最大幅を設定し、中央揃えで表示する
5. WHEN モバイルデバイスでソフトキーボードが表示される THEN 読み返しコンポーネント SHALL 追記エリアがキーボードに隠れないよう配置を調整する

### Requirement 6: 読み返しモードの状態管理

**Objective:** システムとして、読み返しモードの状態を適切に管理したい。これにより、セッションフロー全体との連携がスムーズになる。

#### Acceptance Criteria

1. WHEN 読み返しコンポーネントが初期化される THEN コンポーネント SHALL text プロパティで書き出しモードのテキストを受け取る
2. WHEN 読み返しコンポーネントが初期化される THEN コンポーネント SHALL currentRound と totalRounds プロパティで進行状況を受け取る
3. WHEN 「次へ」ボタンが押される THEN 読み返しコンポーネント SHALL 統合されたメモデータを onNext コールバック経由で親コンポーネントに渡す
4. IF isLastRound プロパティが true THEN 読み返しコンポーネント SHALL 最終ラウンドの表示とボタンラベルを適用する
5. WHEN 読み返しモードがリセットされる THEN 読み返しコンポーネント SHALL 追記エリアをクリアし、新しいテキストを表示する

### Requirement 7: アクセシビリティ対応

**Objective:** すべてのユーザーとして、アクセシブルな読み返し体験をしたい。これにより、多様なユーザーが瞬発思考を実践できる。

#### Acceptance Criteria

1. WHEN 読み返しモードが表示される THEN 読み返しコンポーネント SHALL 適切なaria-label属性を各要素に設定する
2. WHEN 進行状況が更新される THEN 読み返しコンポーネント SHALL スクリーンリーダー向けに進行状況を通知する（aria-live）
3. WHILE ユーザーが操作中 THE 読み返しコンポーネント SHALL キーボードナビゲーションを完全にサポートする
4. WHEN 「次へ」ボタンにフォーカスがある AND Enterキーが押される THEN 読み返しコンポーネント SHALL ボタンクリックと同じ動作を実行する
5. IF ユーザーがハイコントラストモードを使用 THEN 読み返しコンポーネント SHALL 十分なコントラスト比を維持する

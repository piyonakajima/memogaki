# Implementation Plan

## 書き出しモード (writing-mode) 実装タスク

- [x] 1. 型定義とコンポーネント基盤の構築
- [x] 1.1 書き出しモード用の型定義を作成する
  - コンポーネントのプロパティ定義（初期秒数、初期テキスト、プレースホルダー、自動開始フラグ、コールバック関数）
  - コンポーネント内部状態の型定義（テキスト、無効化状態）
  - デフォルト値の定数定義（プレースホルダーテキスト、初期秒数）
  - _Requirements: 5.1, 5.3_

- [x] 1.2 書き出しモードコンポーネントの骨格を作成する
  - コンポーネントの基本構造とプロパティ受け取り
  - 既存タイマーフックとの連携設定
  - テキスト状態管理の初期化（空テキストまたは初期値）
  - エクスポート設定
  - _Requirements: 1.1, 5.1, 5.3_

- [x] 2. テキスト入力機能の実装
- [x] 2.1 テキスト入力エリアの基本機能を実装する
  - 画面の主要領域に表示される入力エリア
  - ユーザー入力のリアルタイム反映
  - 複数行入力時のスクロール対応
  - 入力変更時の親コンポーネントへの通知機能
  - _Requirements: 1.1, 1.2, 1.4, 1.5_

- [x] 2.2 自動フォーカス機能を実装する
  - コンポーネント表示時の入力エリアへの自動フォーカス
  - フォーカス状態の維持（書き出しモードがアクティブな間）
  - _Requirements: 1.3_

- [x] 3. タイマー連携機能の実装
- [x] 3.1 タイマーとの統合を実装する
  - 既存タイマーフックの内部利用
  - 残り時間の表示機能
  - 警告状態（残り5秒以下）の視覚的フィードバック
  - _Requirements: 3.4, 3.5_

- [x] 3.2 自動開始機能を実装する
  - autoStartプロパティによるタイマー自動開始
  - コンポーネントマウント時の開始処理
  - _Requirements: 3.1_

- [x] 3.3 タイマー終了時の処理を実装する
  - タイマー終了時の入力エリア無効化
  - 終了時に入力テキストを確定して親コンポーネントへ通知
  - 完了コールバックの安全な呼び出し
  - _Requirements: 3.2, 3.3, 5.2_

- [x] 4. プレースホルダー機能の実装
- [x] 4.1 プレースホルダー表示機能を実装する
  - 空状態での書き出しヒント表示（デフォルト：「頭に浮かんだことを書いてみましょう...」）
  - カスタムプレースホルダーのサポート
  - 入力開始時のプレースホルダー非表示
  - プレースホルダーの視覚的な区別（本文より薄い色）
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 5. レスポンシブデザインの実装
- [x] 5.1 モバイルレイアウトを実装する
  - 768px未満での全幅表示
  - 適切なパディングの設定
  - タップ操作に適したUI要素サイズ（最小44px）
  - iOSでのズーム防止（font-size: 16px以上）
  - _Requirements: 2.1, 2.2, 2.4_

- [x] 5.2 デスクトップレイアウトを実装する
  - 768px以上での最大幅設定と中央揃え
  - より大きな入力エリア高さ
  - _Requirements: 2.5_

- [x] 5.3 ソフトキーボード対応を実装する
  - キーボード表示時の入力エリア配置調整
  - ビューポートの適切な設定
  - _Requirements: 2.3_

- [x] 6. アクセシビリティ対応の実装
- [x] 6.1 基本的なアクセシビリティ属性を実装する
  - 入力エリアへの適切なaria-label設定
  - フォーカス時の視覚的なアウトライン表示
  - キーボードナビゲーションのサポート
  - _Requirements: 6.1, 6.3_

- [x] 6.2 タイマー警告の音声読み上げ対応を実装する
  - 残り5秒以下でのaria-live通知
  - スクリーンリーダー向けの残り時間アナウンス
  - _Requirements: 6.2_

- [x] 6.3 ハイコントラストモード対応を実装する
  - 十分なコントラスト比の確保
  - 無効化状態の視覚的な区別
  - _Requirements: 6.4_

- [x] 7. 状態管理とリセット機能の実装
- [x] 7.1 コンポーネントリセット機能を実装する
  - リセット時のテキストクリア
  - 初期状態への復帰
  - タイマーのリセット連携
  - _Requirements: 5.4, 5.5_

- [x] 8. テストの実装
- [x] 8.1 ユニットテストを実装する
  - 初期状態での空テキスト表示テスト
  - initialTextによる初期値設定テスト
  - プレースホルダー表示テスト
  - autoStart機能テスト
  - テキスト入力時のonChange呼び出しテスト
  - タイマー終了時のonComplete呼び出しテスト
  - タイマー終了後の入力無効化テスト
  - _Requirements: 全要件の動作確認_

- [x] 8.2 統合テストを実装する
  - タイマーフックとの連携テスト
  - 残り時間表示の更新テスト
  - 警告状態の視覚的反映テスト
  - 親コンポーネントへのコールバック発火テスト
  - _Requirements: 3.1-3.5の統合確認_

- [x] 8.3 アクセシビリティテストを実装する
  - aria-label設定の確認テスト
  - aria-live通知のテスト
  - キーボードナビゲーションテスト
  - フォーカスアウトライン表示テスト
  - _Requirements: 6.1-6.4の確認_

## 要件カバレッジ

| 要件 | タスク |
|------|--------|
| 1.1-1.5 | 1.2, 2.1, 2.2 |
| 2.1-2.5 | 5.1, 5.2, 5.3 |
| 3.1-3.5 | 3.1, 3.2, 3.3 |
| 4.1-4.5 | 4.1 |
| 5.1-5.5 | 1.1, 1.2, 3.3, 7.1 |
| 6.1-6.4 | 6.1, 6.2, 6.3 |

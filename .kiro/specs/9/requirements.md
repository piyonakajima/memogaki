# Requirements Document

## Project Description (Input)

**Google AdSense統合**

### 機能概要
- AdSenseスクリプト導入
- 広告配置（常時表示）
- プライバシーポリシー対応

### ユーザー指定の詳細
- **広告位置**: 画面下部（フッター）に常時表示されるバナー広告
- **プライバシーポリシー**: フッターに小さなリンクとして配置、別ページへ遷移
- **広告タイプ**: ディスプレイ広告（レスポンシブな汎用バナー広告）

---

## Requirements

### FR (Functional Requirements)

#### FR-1: AdSenseスクリプト統合
- **FR-1.1**: Google AdSenseスクリプトを`index.html`のheadセクションに導入する
- **FR-1.2**: AdSenseパブリッシャーID（ca-pub-XXXXXXXXXXXXXXXX形式）を環境変数または設定ファイルで管理可能にする
- **FR-1.3**: スクリプトの非同期読み込み（async）を使用してページ読み込みをブロックしない

#### FR-2: フッター広告表示
- **FR-2.1**: 画面下部に固定表示されるフッターバナー広告を実装する
- **FR-2.2**: ディスプレイ広告ユニット（レスポンシブ形式）を使用する
- **FR-2.3**: 広告スロットID（data-ad-slot）を設定可能にする
- **FR-2.4**: 広告が読み込まれるまでの間、適切な高さを確保してレイアウトシフトを防ぐ
- **FR-2.5**: 広告の読み込み失敗時または広告ブロッカー使用時は、広告領域を非表示にする（空白を残さない）

#### FR-3: プライバシーポリシーページ
- **FR-3.1**: プライバシーポリシーを表示する専用ページ（`/privacy`）を作成する
- **FR-3.2**: フッターに「プライバシーポリシー」リンクを配置する
- **FR-3.3**: リンクはReact Routerを使用した内部遷移、またはGitHub Pages対応のハッシュベースルーティングで実装する
- **FR-3.4**: プライバシーポリシーページには以下の内容を含める：
  - 情報収集に関する説明（Cookieの使用）
  - Google AdSenseによる広告配信の説明
  - 第三者への情報提供に関する説明
  - お問い合わせ方法

#### FR-4: フッターコンポーネント
- **FR-4.1**: アプリケーション全体で使用するフッターコンポーネントを作成する
- **FR-4.2**: フッターには広告領域とプライバシーポリシーリンクを含める
- **FR-4.3**: フッターは画面下部に固定位置（sticky/fixed）で表示する
- **FR-4.4**: メインコンテンツがフッターに隠れないよう、適切なパディング/マージンを確保する

---

### NFR (Non-Functional Requirements)

#### NFR-1: パフォーマンス
- **NFR-1.1**: AdSenseスクリプトの読み込みがFirst Contentful Paint (FCP)を2秒以上遅延させない
- **NFR-1.2**: 広告読み込みによるCumulative Layout Shift (CLS)を0.1未満に抑える
- **NFR-1.3**: 広告コンポーネントは遅延読み込み（lazy loading）に対応する

#### NFR-2: レスポンシブデザイン
- **NFR-2.1**: 広告サイズはデバイス幅に応じて自動調整される
- **NFR-2.2**: モバイル（320px〜768px）: 画面幅に合わせた横長バナー
- **NFR-2.3**: タブレット/デスクトップ（768px〜）: 標準的なリーダーボード形式
- **NFR-2.4**: 広告がコンテンツの可読性を損なわない

#### NFR-3: ユーザーエクスペリエンス
- **NFR-3.1**: 広告はアプリの主要操作（タイマー、テキスト入力）を妨げない
- **NFR-3.2**: 書き出しモード・読み返しモード中はテキスト入力エリアが広告に隠れない
- **NFR-3.3**: フッターの高さは最大80pxとし、コンテンツ表示領域を確保する

#### NFR-4: 法令遵守
- **NFR-4.1**: Google AdSenseポリシーに準拠する
- **NFR-4.2**: 広告の近くに誤クリックを誘発する要素を配置しない
- **NFR-4.3**: プライバシーポリシーは日本語で記載する
- **NFR-4.4**: GDPR/個人情報保護法に関する最低限の説明を含める

#### NFR-5: 保守性
- **NFR-5.1**: AdSense設定（パブリッシャーID、スロットID）は一箇所で管理する
- **NFR-5.2**: 広告コンポーネントは他のコンポーネントと疎結合にする
- **NFR-5.3**: 広告を無効化するフラグを設けて、開発環境では広告を表示しないオプションを提供する

#### NFR-6: 既存デザインとの整合性
- **NFR-6.1**: フッターのデザインは既存の「ノート風テーマ」と調和させる
- **NFR-6.2**: プライバシーポリシーリンクは目立ちすぎない控えめなスタイルにする
- **NFR-6.3**: 広告領域の背景色・ボーダーは既存カラーパレットに準拠する

---

### 技術的制約

#### TC-1: ホスティング環境
- GitHub Pages（静的ホスティング）でのデプロイを前提とする
- SPAルーティングはハッシュベース（`/#/privacy`）または404.htmlフォールバックを使用する

#### TC-2: 既存技術スタック
- React 18.x + TypeScript
- Vite ビルドシステム
- CSS Modules または既存のコンポーネントベースCSS

#### TC-3: AdSense要件
- AdSenseアカウントの承認が必要（本番デプロイ前に取得）
- テスト環境では`data-adtest="on"`属性を使用

---

### 受け入れ基準

| ID | 基準 | 検証方法 |
|----|------|----------|
| AC-1 | フッターにディスプレイ広告が表示される | ブラウザで確認（AdSense承認後） |
| AC-2 | プライバシーポリシーリンクをクリックすると専用ページに遷移する | E2Eまたは手動テスト |
| AC-3 | モバイルデバイスで広告サイズが適切に調整される | デバイスエミュレータで確認 |
| AC-4 | 広告ブロッカー使用時に空白が残らない | 広告ブロッカー拡張機能で確認 |
| AC-5 | メインコンテンツ（テキストエリア）がフッターに隠れない | 各モードで確認 |
| AC-6 | 開発環境で広告を無効化できる | 環境変数設定で確認 |

---

### スコープ外

- 複数の広告ユニット配置（フッター以外）
- 広告収益のダッシュボード表示
- A/Bテスト機能
- Cookie同意バナー（別途specで対応検討）
- 他の広告ネットワークとの統合

---

## 次のステップ

1. **レビュー**: この要件ドキュメントを確認し、修正・追加があればお知らせください
2. **承認後**: `/kiro:spec-design 9` で技術設計を作成
